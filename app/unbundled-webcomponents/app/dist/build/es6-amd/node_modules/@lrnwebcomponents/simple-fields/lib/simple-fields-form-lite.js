define(["exports","../../../lit-element/lit-element.js","./simple-fields-lite.js","../simple-fields.js"],(function(_exports,_litElement,_simpleFieldsLite,_simpleFields){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.SimpleFieldsFormLite=void 0;class SimpleFieldsFormLite extends _litElement.LitElement{static get styles(){return[_litElement.css`
        :host {
          display: block;
        }
      `]}static get tag(){return"simple-fields-form-lite"}render(){return _litElement.html`
      <form>
        <slot name="before"></slot>
        <simple-fields-lite
          id="sf"
          .autofocus="${!this.disableAutofocus}"
          .language="${this.language}"
          .resources="${this.resources}"
          .schema="${this.schema}"
          .elementizer="${this.elementizer}"
          .value="${this.value}"
          @value-changed="${this._valueChanged}"
        >
        </simple-fields-lite>
        <slot name="after"></slot>
        <slot></slot>
      </form>
    `}_valueChanged(e){this.value=e.detail.value}setValue(value){this.value=value}firstUpdated(changedProperties){changedProperties.forEach((oldValue,propName)=>{"loadEndpoint"===propName&&this.autoload&&this.loadData()})}updated(changedProperties){changedProperties.forEach((oldValue,propName)=>{!this.autoload||this.loadResponse||this.loading||"loadEndpoint"!==propName&&"autoload"!==propName||this.loadData(),"loadResponse"===propName&&this.loadResponse.data&&(this._applyLoadedData(),this.dispatchEvent(new CustomEvent("response",{bubbles:!0,composed:!0,cancelable:!1,detail:this.loadResponse})))})}_applyLoadedData(){this.loadResponse.data.schema&&(this.schema=this.loadResponse.data.schema),this.loadResponse.data.value&&(this.value=this.loadResponse.data.value)}loadData(){this.loading=!0,this.fetchData(this.loadEndpoint,this.method,this.headers,this.body).then(data=>{this.loading=!1,this.loadResponse=data,this.dispatchEvent(new CustomEvent("simple-fields-form-data-loaded",{detail:{value:data}}))})}async fetchData(path,method,headers,body){let response={};return"GET"==method?(body&&(path+="?"+Object.entries(body).map(([key,val])=>`${encodeURIComponent(key)}=${encodeURIComponent(val)}`).join("&")),response=await fetch(path,{method:method,headers:headers})):response=await fetch(path,{method:method,headers:headers,body:JSON.stringify(body)}),await response.json()}constructor(){super(),this._setFieldProperties(),this._setFormProperties()}_setFieldProperties(){this.disableAutofocus=!1,this.language="en",this.resources={},this.schema={},this.value={}}_setFormProperties(){this.method="POST",this.loading=!1,this.autoload=!1,this.headers={Accept:"application/json","Content-Type":"application/json"},this.body={}}submit(){let sf=this.shadowRoot.querySelector("#sf");return this.saveEndpoint&&fetch(this.saveEndpoint,{method:this.method,headers:this.headers,body:JSON.stringify(sf.value)}),sf.value}static get fieldProperties(){return{disableAutofocus:{type:Boolean},error:{type:Object},language:{type:String,attribute:"lang",reflect:!0},resources:{type:Object},schema:{type:Object},schemaConversion:{type:Object,attribute:"schema-conversion"},value:{type:Object}}}static get formProperties(){return{autoload:{type:Boolean,reflect:!0},loading:{type:Boolean,reflect:!0},loadEndpoint:{type:String,attribute:"load-endpoint"},saveEndpoint:{type:String,attribute:"save-endpoint"},method:{type:String},headers:{type:Object},body:{type:Object},loadResponse:{type:Object}}}get formFields(){return this.shadowRoot&&this.shadowRoot.querySelector&&this.shadowRoot.querySelector("#sf")?this.shadowRoot.querySelector("#sf"):void 0}get formElements(){return this.formFields?this.formFields.formElements:{}}get formElementsArray(){return this.formFields?this.formFields.formElementsArray:[]}static get properties(){return{...this.fieldProperties,...this.formProperties}}}_exports.SimpleFieldsFormLite=SimpleFieldsFormLite,window.customElements.define(SimpleFieldsFormLite.tag,SimpleFieldsFormLite)}));