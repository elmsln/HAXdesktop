define(["exports","../../lit-element/lit-element.js","./lib/singletons/rich-text-editor-selection.js","./lib/rich-text-editor-styles.js","./lib/toolbars/rich-text-editor-toolbar.js","./lib/toolbars/rich-text-editor-toolbar-mini.js","./lib/toolbars/rich-text-editor-toolbar-full.js","../../shadow-selection-polyfill/shadow.js"],(function(_exports,_litElement,_richTextEditorSelection,_richTextEditorStyles,_richTextEditorToolbar,_richTextEditorToolbarMini,_richTextEditorToolbarFull,shadow){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.RichTextEditor=void 0,shadow=babelHelpers.interopRequireWildcard(shadow);
/**
   * Copyright 2018 The Pennsylvania State University
   * @license Apache-2.0, see License.md for full text.
   */
class RichTextEditor extends((0,_richTextEditorStyles.RichTextEditorStyles)(_litElement.LitElement)){static get styles(){return[...super.styles,_litElement.css`
        :host([hidden]) {
          display: none;
        }

        :host {
          display: block;
          cursor: pointer;
          min-height: 40px;
        }

        :host([contenteditable="true"]) {
          border: var(--rich-text-editor-border);
          overflow: auto;
        }

        :host([contenteditable="true"]):focus-within,
        :host([contenteditable="true"]):focus {
          padding: 2px;
          margin-bottom: 2px;
        }

        :host(.heightmax[contenteditable="true"]) {
          max-height: calc(100vh - 200px);
          overflow-y: scroll;
        }

        :host(:empty) {
          border: 1px dashed var(--rich-text-editor-border-color);
          outline: 1px dashed var(--rich-text-editor-border-color);
        }

        :host(:empty):before {
          content: attr(placeholder);
          padding: 0 5px;
          display: block;
          z-index: -1;
          color: var(--rich-text-editor-button-disabled-color);
        }

        *::selection .rich-text-editor-selection {
          background-color: var(--rich-text-editor-selection-bg);
        }

        ::slotted(*:first-child) {
          margin-top: 0;
        }

        ::slotted(*:last-child) {
          margin-bottom: 0;
        }
      `]}render(){return _litElement.html` <slot></slot>`}static get haxProperties(){return{canScale:!0,canPosition:!0,canEditSource:!0,gizmo:{title:"Rich text-editor",description:"a standalone rich text editor",icon:"icons:android",color:"green",groups:["Text"],handles:[{type:"todo:read-the-docs-for-usage"}],meta:{author:"nikkimk",owner:"Penn State University"}},settings:{configure:[{property:"title",description:"",inputMethod:"textfield",required:!1,icon:"icons:android"}],advanced:[]}}}static get properties(){return{...super.properties,id:{name:"id",type:String,reflect:!0,attribute:"id"},contenteditable:{name:"contenteditable",type:Boolean,reflect:!0,attribute:"contenteditable"},placeholder:{name:"placeholder",type:String,reflect:!0,attribute:"placeholder"},toolbar:{name:"toolbar",type:String,reflect:!0,attribute:"toolbar"},range:{name:"range",type:Object,attribute:"range"},type:{name:"type",type:String,reflect:!0,attribute:"type"},updateRange:{type:Boolean},__canceledEdits:{type:Object},__connectedToolbar:{type:Object},__selection:{type:Object}}}static get tag(){return"rich-text-editor"}constructor(){super(),this.haxUIElement=!0,window.RichTextEditorStyleManager.requestAvailability(),this.placeholder="Click to edit",this.toolbar="",this.type="rich-text-editor-toolbar",this.id="",this.range=void 0,this.__selection=window.RichTextEditorSelection.requestAvailability(),document.addEventListener(shadow.eventName,this._getRange.bind(this))}_getRange(){let shadowRoot=el=>{let parent=el.parentNode;return parent?shadowRoot(parent):el};this.range=shadow.getRange(shadowRoot(this)),this.updateRange()}get observer(){let root=this;return new MutationObserver(e=>root._getRange(e))}connectedCallback(){super.connectedCallback(),this.register()}disconnectedCallback(){super.disconnectedCallback(),this.register(!0)}firstUpdated(){super.firstUpdated&&super.firstUpdated(),this.isEmpty()&&(this.innerHTML=""),this._editableChange()}updated(changedProperties){super.updated(changedProperties),changedProperties.forEach((oldValue,propName)=>{"contenteditable"===propName&&this._editableChange(),"range"===propName&&this._rangeChange()})}haxHooks(){return{activeElementChanged:"haxactiveElementChanged"}}haxactiveElementChanged(el,val){return!val&&el&&(el.innerHTML=this.getValue()),el}getValue(){return this.isEmpty||this.trimmerHTML(this)===`<p>${editor.placeholder}</p>`?"":this.innerHTML}isEmpty(){return!this.innerHTML||""==this.trimmerHTML(this)}makeSticky(sticky=!0){sticky?this.classList.remove("heightmax"):this.classList.add("heightmax")}observeChanges(on=!0){if(on){let editor=this;this.observer.observe(editor,{attributes:!1,childList:!0,subtree:!0,characterData:!1})}else this.observer&&this.observer.disconnect}paste(pasteContent,sanitized=!0){this._handlePaste(pasteContent)}register(remove=!1){window.dispatchEvent(new CustomEvent("register",{bubbles:!0,cancelable:!0,composed:!0,detail:{remove:remove,editor:this}}))}revert(){this.innerHTML=this.__canceledEdits}rootNode(){return this.__selection?this.__selection.getRoot(this):document}setCancelHTML(html=this.innerHTML){this.__canceledEdits=html}trimmerHTML(node){return node.innerHTML.replace(/[\s\t\r\n]/gim,"")}updateRange(e){this.dispatchEvent(new CustomEvent("getrange",{bubbles:!0,cancelable:!0,composed:!0,detail:this}))}_editableChange(){let placeholder=`<p>${this.placeholder}</p>`;this.contenteditable?(this.setCancelHTML(),this.isEmpty()&&(this.innerHTML=placeholder)):this.trimmerHTML(this)===placeholder&&this.setCancelHTML("")}_handlePaste(e){let pasteContent="";e&&(e.clipboardData||e.originalEvent.clipboardData)?pasteContent=(e.originalEvent||e).clipboardData.getData("text/html"):window.clipboardData&&(pasteContent=window.clipboardData.getData("Text")),this.dispatchEvent(new CustomEvent("pastefromclipboard",{bubbles:!0,cancelable:!0,composed:!0,detail:this})),e.preventDefault()}_rangeChange(e){}}_exports.RichTextEditor=RichTextEditor,window.customElements.define(RichTextEditor.tag,RichTextEditor)}));