define(["exports","../../../../lit-element/lit-element.js","./rich-text-editor-button.js","../singletons/rich-text-editor-selection.js","../singletons/rich-text-editor-prompt.js"],(function(_exports,_litElement,_richTextEditorButton,_richTextEditorSelection,_richTextEditorPrompt){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.RichTextEditorPromptButtonBehaviors=_exports.RichTextEditorPromptButton=void 0;
/**
   * Copyright 2019 Penn State University
   * @license Apache-2.0, see License.md for full text.
   */
const RichTextEditorPromptButtonBehaviors=function(SuperClass){return class extends((0,_richTextEditorButton.RichTextEditorButtonBehaviors)(SuperClass)){static get tag(){return"rich-text-editor-prompt-button"}render(){return super.render()}static get properties(){return{...super.properties,fields:{type:Array},inlineWidget:{name:"inlineWidget",type:Boolean},id:{name:"id",type:String,reflect:!0,attribute:"id"},tag:{name:"tag",type:String},value:{type:Object},prompt:{name:"prompt",type:Object},__wrap:{name:"__wrap",type:Object},__oldValue:{name:"__oldValue",type:Object}}}constructor(){super(),this.editableSelection=!1,this.inlineWidget=!1,this.fields=[{property:"innerHTML",title:"Text",inputMethod:"textfield"}],this.tag="span",this.value={innerHTML:void 0},this.prompt=window.RichTextEditorPrompt.requestAvailability()}get promptCommand(){return this.toggledCommand&&!this.toggled?this.toggledCommand:this.command}get promptCommandVal(){return this.commandVal}get setsInnerHTML(){let innerHTML=(this.fields||[]).filter(field=>"innerHTML"===field.property);return innerHTML&&innerHTML.length>0}cancel(){}confirm(val){this.value=val,this.update(),this.setToggled(),this.promptCommandVal,this.updateSelection()}expandSelection(){let element=this.rangeQuery();element&&this.highlightNode(element)}getInnerHTML(){let temp,html,target=this.range&&this.range.cloneContents?this.range.cloneContents():void 0,root=this.rangeElement()?this.rangeElement():void 0;return this.rangeIsElement()?html=root?root.innerHTML:void 0:(temp=document.createElement("span"),target&&temp.appendChild(target),html=temp.innerHTML,temp.remove()),html}getPropValue(prop){let val=!!this.value&&this.value,rawVal=!(!val||!val[prop])&&(val[prop].trim?val[prop].trim():val[prop]);return!(!rawVal||""===rawVal)&&rawVal}getValue(){return{innerHTML:this.getInnerHTML()||""}}open(){this.expandSelection(),this.value=this.getValue(),this.prompt.fields=[...this.fields],this.prompt.value={...this.value},this.dispatchEvent(new CustomEvent("rich-text-editor-prompt-open",{bubbles:!0,cancelable:!0,composed:!0,detail:this}))}setInnerHTML(html){let target=this.rangeElement();target&&this.rangeIsElement()?target.innerHTML=html:this.range&&this.sendCommand("insertHtml",html)}setToggled(){this.toggled=!this.value}updateSelection(){let range=this.range.cloneRange();this.sendCommand(this.promptCommand,this.promptCommandVal),this.selectRange(range),this.setsInnerHTML&&this.setInnerHTML(this.getPropValue("innerHTML"))}_buttonTap(e){e.preventDefault(),this.open()}_rangeChanged(newVal,oldVal){this.value=this.getValue(),this.setToggled()}}};_exports.RichTextEditorPromptButtonBehaviors=RichTextEditorPromptButtonBehaviors;class RichTextEditorPromptButton extends(RichTextEditorPromptButtonBehaviors(_litElement.LitElement)){}_exports.RichTextEditorPromptButton=RichTextEditorPromptButton,window.customElements.define(RichTextEditorPromptButton.tag,RichTextEditorPromptButton)}));