import{html,LitElement}from"../../../lit-element/lit-element.js";import{render}from"../../../lit-html/lib/render.js";import{unsafeHTML}from"../../../lit-html/directives/unsafe-html.js";import"./simple-popover-manager.js";class SimplePopoverSelection extends LitElement{constructor(){super(),this.disabled=!1}openedToggle(e){this.disabled||(this.opened=!this.opened)}openedChanged(state){if(state){let div=document.createElement("div");render(div,window.SimplePopoverManager.requestAvailability());let content,slot=this.querySelectorAll('[slot="options"]');for(var i in 1===slot.length&&slot[0].children&&1===slot[0].children.length&&"SLOT"===slot[0].children[0].tagName&&(slot=slot[0].children[0].assignedNodes({flatten:!0})),slot)if(slot[i].cloneNode&&slot[i].tagName){let clone=slot[i].cloneNode(!0);clone.removeAttribute("slot"),div.appendChild(clone)}if(this.querySelector('[slot="style"]')){let styleData=this.querySelector('[slot="style"]').cloneNode(!0),style=document.createElement("style");style.innerHTML=styleData.innerHTML,content=html`${unsafeHTML(div.innerHTML)}${unsafeHTML(style.outerHTML)}`}else content=html`${unsafeHTML(div.innerHTML)}`;render(content,window.SimplePopoverManager.requestAvailability()),setTimeout(()=>{let children=window.SimplePopoverManager.requestAvailability().querySelectorAll("*");for(var i in children)children[i].addEventListener&&children[i].addEventListener("click",this.itemSelect.bind(this));window.SimplePopoverManager.requestAvailability().querySelector("[data-simple-popover-selection-active]")?window.SimplePopoverManager.requestAvailability().querySelector("[data-simple-popover-selection-active]").focus():window.SimplePopoverManager.requestAvailability()&&window.SimplePopoverManager.requestAvailability().querySelector(":first-child")&&window.SimplePopoverManager.requestAvailability().querySelector(":first-child").focus()},0)}window.SimplePopoverManager.requestAvailability().setPopover(this,this.querySelector('[slot="button"]'),state)}managerReset(){this.opened=!1}updated(changedProperties){changedProperties.forEach((oldValue,propName)=>{"opened"==propName&&this.shadowRoot&&this.openedChanged(this[propName])})}itemSelect(e){this.dispatchEvent(new CustomEvent("simple-popover-selection-changed",{bubbles:!0,detail:e.target})),this.opened=!1,setTimeout(()=>{window.SimplePopoverManager.requestAvailability().setPopover(this,this.querySelector('[slot="button"]'),!1),this.querySelector('[slot="button"]').focus()},0)}static get properties(){return{opened:{type:Boolean,reflect:!0},disabled:{type:Boolean,reflect:!0}}}firstUpdated(){this.addEventListener("click",this.openedToggle.bind(this))}render(){return html`<slot name="button"></slot>`}}customElements.define("simple-popover-selection",SimplePopoverSelection);export{SimplePopoverSelection};