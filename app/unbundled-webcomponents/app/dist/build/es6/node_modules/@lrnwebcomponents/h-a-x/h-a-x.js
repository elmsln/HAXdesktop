/**
 * Copyright 2019 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */
import{HAXStore}from"../hax-body/lib/hax-store.js";class HAX extends HTMLElement{get html(){return"\n    <style>\n    :host,h-a-x {\n      display: block;\n      font-size: var(--haxcms-base-styles-body-font-size);\n      font-family: var(--haxcms-base-styles-body-font-family);\n      line-height: var(--haxcms-base-styles-body-line-height);\n      letter-spacing: var(--haxcms-base-styles-body-letter-spacing);\n    }\n\n    :host([hidden]),h-a-x([hidden]) {\n      display: none;\n    }\n\n    :host hax-body, h-a-x hax-body {\n      font-size: var(--haxcms-base-styles-body-font-size);\n      font-family: var(--haxcms-base-styles-body-font-family);\n      line-height: var(--haxcms-base-styles-body-line-height);\n      letter-spacing: var(--haxcms-base-styles-body-letter-spacing);\n    }\n\n    :host img, h-a-x img {\n      max-width: 100%;\n      max-width: -moz-available;\n      max-width: -webkit-fill-available;\n      max-width: fill-available;\n    }\n\n    :host h1, h-a-x h1 {\n      font-size: var(--hax-base-styles-h1-font-size);\n      line-height: var(--hax-base-styles-h1-line-height);\n    }\n\n    :host h2, h-a-x h2 {\n      font-size: var(--hax-base-styles-h2-font-size);\n    }\n\n    :host h3, h-a-x h3 {\n      font-size: var(--hax-base-styles-h3-font-size);\n    }\n\n    :host h4, h-a-x h4 {\n      font-size: var(--hax-base-styles-h4-font-size);\n    }\n\n    :host h5, h-a-x h5 {\n      font-size: var(--hax-base-styles-h5-font-size);  \n    }\n\n    :host h6, h-a-x h6 {\n      font-size: var(--hax-base-styles-h6-font-size);\n    }\n\n    :host p, h-a-x p {\n      min-height: var(--hax-base-styles-p-min-height);\n      font-size: var(--hax-base-styles-p-font-size);\n      line-height: var(--hax-base-styles-p-line-height);\n      letter-spacing: var(--hax-base-styles-p-letter-spacing);\n    }\n\n    :host a,\n    :host a:-webkit-any-link,\n    h-a-x a,\n    h-a-x a:-webkit-any-link    {\n      font-size: var(--hax-base-styles-a-font-size,var(--hax-base-styles-p-font-size));\n    }\n\n    :host ol,\n    :host ul\n    :host ol li,\n    :host ul li,\n    h-a-x ol,\n    h-a-x ul\n    h-a-x ol li,\n    h-a-x ul li {\n      line-height: var(--hax-base-styles-list-line-height,var(--hax-base-styles-p-line-height));\n      font-size: var(--hax-base-styles-list-font-size,var(--hax-base-styles-p-font-size));\n    }\n\n    :host ul ul,\n    :host ul ol,\n    :host ol ul,\n    :host ol ol,\n    h-a-x ul ul,\n    h-a-x ul ol,\n    h-a-x ol ul,\n    h-a-x ol ol {\n      padding-bottom: unset;\n    }\n    </style>\n    <hax-body>\n        <slot></slot>\n    </hax-body>"}static get tag(){return"h-a-x"}constructor(delayRender=!1){super(),this.__rendered=!1,this.tag=HAX.tag,this.template=document.createElement("template"),this.attachShadow({mode:"open"}),delayRender||this.render(),window.addEventListener("hax-store-ready",this.storeReady.bind(this),{once:!0,passive:!0}),window.addEventListener("hax-store-app-store-loaded",this.appStoreReady.bind(this),{once:!0,passive:!0}),import("./lib/h-a-x-dependencies.js"),window.addEventListener("hax-cancel",this.cancelEvent.bind(this)),window.addEventListener("hax-save",this.saveEvent.bind(this))}cancelEvent(e){this.importSlotToHaxBody()}saveEvent(e){this.innerHTML=HAXStore.activeHaxBody.haxToContent()}connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.__HAXApplied||window.__HAXApplied||(window.__HAXApplied=this.__HAXApplied=this.applyHAX())}storeReady(e){e.detail&&(setTimeout(()=>{try{let appStore={...JSON.parse(this.getAttribute("app-store"))};"object"==typeof appStore&&(HAXStore.appStore=appStore)}catch(e){console.warn(e)}"hide-panel-ops"===this.hidePanelOps&&(this.hidePanelOps=!0),HAXStore.haxTray.hidePanelOps=this.hidePanelOps,HAXStore.haxTray.offsetMargin=this.offsetMargin,HAXStore.haxTray.elementAlign=this.elementAlign},0),window.removeEventListener("hax-store-ready",this.storeReady.bind(this),{once:!0,passive:!0}))}importSlotToHaxBody(){var nodes=[];nodes=this.shadowRoot.querySelector("slot")?this.shadowRoot.querySelector("slot").assignedNodes():this.children;let body="";for(let i in nodes)void 0!==nodes[i].outerHTML&&(body+=nodes[i].outerHTML);HAXStore.activeHaxBody.importContent(body)}appStoreReady(e){e.detail&&(this.importSlotToHaxBody(),window.removeEventListener("hax-store-app-store-loaded",this.appStoreReady.bind(this),{once:!0,passive:!0}))}render(){this.__rendered=!0,this.shadowRoot.innerHTML=null,this.template.innerHTML=this.html,this.shadowRoot.appendChild(this.template.content.cloneNode(!0))}applyHAX(){window.HaxStore.requestAvailability();let tray=document.createElement("hax-tray");return tray.hidePanelOps=this.hidePanelOps,tray.elementAlign=this.elementAlign,document.body.appendChild(tray),document.body.appendChild(document.createElement("hax-app-picker")),document.body.appendChild(document.createElement("hax-export-dialog")),document.body.appendChild(document.createElement("hax-autoloader")),!0}disconnectedCallback(){window.removeEventListener("hax-store-ready",this.storeReady.bind(this),{once:!0,passive:!0}),window.removeEventListener("hax-store-app-store-loaded",this.appStoreReady.bind(this),{once:!0,passive:!0}),window.removeEventListener("hax-cancel",this.cancelEvent.bind(this)),window.removeEventListener("hax-save",this.saveEvent.bind(this)),super.disconnectedCallback&&super.disconnectedCallback()}static get observedAttributes(){return["element-align","offset-margin","app-store","hide-panel-ops"]}get elementAlign(){return this.getAttribute("element-align")}set elementAlign(newValue){this.__rendered&&(this.setAttribute("element-align",newValue),HAXStore.haxTray.elementAlign=newValue)}get offsetMargin(){return this.getAttribute("offset-margin")}set offsetMargin(newValue){this.setAttribute("offset-margin",newValue),this.__rendered&&(HAXStore.haxTray.offsetMargin=newValue)}get hidePanelOps(){return this.getAttribute("hide-panel-ops")}set hidePanelOps(newValue){newValue&&(this.setAttribute("hide-panel-ops","hide-panel-ops"),this.__rendered&&(HAXStore.haxTray.hidePanelOps=newValue))}get appStore(){return this.getAttribute("app-store")}set appStore(newValue){this.setAttribute("app-store",newValue),this.__rendered&&(HAXStore.appStore={...JSON.parse(this.getAttribute("app-store"))})}attributeChangedCallback(attr,oldValue,newValue){}}window.customElements.define("h-a-x",HAX);export{HAX};